# 🤖 Система классификации токсичного аудио-контента

Бот для автоматической классификации голосовых сообщений на предмет токсичности с использованием машинного обучения и современных языковых моделей.

## 📋 Описание проекта

Проект представляет собой комплексное решение для модерации аудио-контента, состоящее из:
- **Telegram-бота** для приема голосовых сообщений
- **Агента классификации** на базе DistilBERT
- **API для транскрипции** аудио в текст

## 🎯 Классификация контента

Система классифицирует контент на **3 категории**:
- **0. Токсичный** — содержащий угрозы, агрессию, обещание совершить насильственные действия
- **1. Оскорбительный** — содержащий уничижительные высказывания, но без явной угрозы  
- **2. Нейтральный** — без признаков токсичности или оскорблений

## 🏗️ Архитектура системы

```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   Telegram Bot  │───▶│  Google Gemini   │───▶│  Agent Service  │
│                 │    │  (STT)           │    │                 │
└─────────────────┘    └──────────────────┘    └─────────────────┘
```

### Компоненты:

1. **`bot/`** - Telegram-бот на aiogram
   - Принимает голосовые сообщения
   - Отправляет аудио на транскрипцию
   - Получает результат классификации

2. **`agent/`** - Сервис классификации на FastAPI
   - Использует DistilBERT для анализа
   - Валидация и обработка ответов
   - REST API для интеграции

3. **`training/`** - Модели машинного обучения
   - Логистическая регрессия (LogReg)
   - Нейронные сети (CNN, RNN)
   - Transformer модель (DistilBERT)

4. **`datasets/`** - Обучающие данные
   - Английский датасет токсичных комментариев
   - Русский датасет токсичных комментариев


## 🚀 Установка и запуск

### Требования:
```bash
pip install aiogram fastapi uvicorn google-generativeai python-dotenv aiohttp
```

### Переменные окружения:
```bash
# .env файл
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
GOOGLE_API_KEY=your_google_api_key
```

### Запуск:

1. **Агент (порт 8000):**
```bash
cd agent/
python agent.py
```

2. **Telegram-бот:**
```bash
cd bot/
python bot.py
```

## 📊 Результаты

## 📊 Сравнительная таблица моделей

| Модель              | Метрики                                         |
|---------------------|-------------------------------------------------|
| DistilBERT          | Accuracy: 96.36%, F1-score: 96.36% (EN+RU)      |
| BiLSTM (MLebedeva)  | Accuracy: 96.11%, F1-score: 89.89% (RU)         |
| BiLSTM (MLebedeva)  | Accuracy: 94.71%, F1-score: 72.25% (EN)         |
| BiLSTM              | Accuracy: 91.00% (EN+RU)                        |
| BiGRU               | Accuracy: 90.29% (EN+RU)                        |
| CNN                 | Accuracy: 89.27%, F1-score: 75.42% (EN+RU)      |
| CNN (Base)          | Accuracy: 89.39% (EN+RU)                        |

### 🏆 Выбор модели
**DistilBERT** показал наилучшие результаты и выбран для продакшена благодаря:
- Высокой точности (96.36%)
- Мультиязычной поддержке
- Компактному размеру (66M параметров)
- Быстрому инференсу


## 📁 Структура проекта

```
Toxic_classification/
├── bot/                    # Telegram-бот
│   └── bot.py
├── agent/                  # Сервис классификации
│   └── agent.py
├── training/               # Обучение моделей
│   ├── toxic_transformer.ipynb      # Transformer (лучшая модель)
│   ├── Toxic_class_logreg_*.ipynb   # Логистическая регрессия
│   ├── MLebedeva_toxic_bilstm_*.ipynb # BiLSTM модели
│   └── cc.en.300.bin       # FastText эмбеддинги
├── datasets/               # Обучающие данные
│   ├── eng_toxic_full_df.csv
│   └── rus_toxic_full_df.csv
├── reports/                # Отчеты и документация
│   ├── Отчет_детектор_токсичности.pdf
│   └── Техническое_описание_датасетов_Команды_5.pdf
└── README.md
```

## 🔧 Технические детали

### API интеграции:
- **Google Gemini 2.5 Pro** - транскрипция аудио
- **FastAPI** - REST API для агента
- **aiogram** - Telegram Bot API


## 👥 Команда

Проект выполнен в рамках курса NLP (Семестр 3)
1. Климов Святослав Дмитриевич
2. Алиев Эльхан Вагиф оглы
3. Веретнова Мария Рашитовна
4. Балабанова Алевтина Сергеевна
5. Лебедева Марина Сергеевна
6. Шельпякова Марианна Борисовна
7. Галиева Анна Борисовна

